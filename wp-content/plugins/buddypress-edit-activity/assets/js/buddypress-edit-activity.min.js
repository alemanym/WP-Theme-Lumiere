function buddypress_edit_activity_initiate(t){return jQuery(t).hasClass("action-save")?buddypress_edit_activity_save(t):buddypress_edit_activity_get(t),!1}function buddypress_edit_activity_get(t){if(1==jQuery("li.activity-item #buddypress-edit-activity-wrapper").length&&($edit_wrapper=jQuery("li.activity-item #buddypress-edit-activity-wrapper"),$cancel_button=$edit_wrapper.next().children(".buddyboss_edit_activity_cancel"),$cancel_button.trigger("click"),window.keep_activity_changes))return!1;$link=jQuery(t),$form=jQuery("#frm_buddypress-edit-activity"),$form_wrapper=$form.parent(),$link.addClass("loading"),$link.hasClass("buddyboss_edit_activity_comment")?B_E_A_.current_activity_org=$link.closest("[id^=acomment]").find(" > .acomment-content").html():B_E_A_.current_activity_org=$link.closest("li").find(".activity-inner").html();var i={action:$form.find('input[name="action_get"]').val(),buddypress_edit_activity_nonce:$form.find('input[name="buddypress_edit_activity_nonce"]').val(),activity_id:$link.data("activity_id")};jQuery.ajax({type:"POST",url:ajaxurl,data:i,success:function(t){if(t=jQuery.parseJSON(t),console.log("GET data..."+i.activity_id),console.log("GET data - resp status:"+t.status),console.log("GET data - resp content:"+t.content),t.status){$link.removeClass("loading").addClass("action-save").html(B_E_A_.button_text.save);var e=jQuery("<a href='#'>").addClass("bp-secondary-action buddyboss_edit_activity_cancel").html(B_E_A_.button_text.cancel);$link.before(e),e.attr("onclick","return buddypress_edit_activity_cancel(this);"),e.data("target_type","activity"),$link.hasClass("buddyboss_edit_activity_comment")?($link.closest("[id^=acomment]").find(" > .acomment-content").html("").hide().after($form_wrapper),e.data("target_type","comment")):($link.closest("li").find(".activity-inner").html("").hide().after($form_wrapper),e.addClass("button")),$form_wrapper.show(),$form.find('input[name="activity_id"]').val(i.activity_id),$form.find("textarea").trumbowyg("html",t.content)}}})}function buddypress_edit_activity_save(t){$link=jQuery(t),$form=jQuery("#frm_buddypress-edit-activity"),$form_wrapper=$form.parent(),$link.addClass("loading"),jQuery(".buddyboss_edit_activity_cancel").remove();var i={action:$form.find('input[name="action_save"]').val(),buddypress_edit_activity_nonce:$form.find('input[name="buddypress_edit_activity_nonce"]').val(),activity_id:$link.data("activity_id"),content:$form.find("textarea").val()};jQuery.ajax({type:"POST",url:ajaxurl,data:i,success:function(t){(t=jQuery.parseJSON(t)).status&&($link.removeClass("loading").removeClass("action-save").html(B_E_A_.button_text.edit),$link.hasClass("buddyboss_edit_activity_comment")?$link.closest("[id^=acomment]").find(" > .acomment-content").html(t.content).show():$link.closest("li").find(".activity-inner").html(t.content).show(),$form_wrapper.hide(),jQuery("body").append($form_wrapper),window.activity_content_changed=!1,window.keep_activity_changes=!1)}})}function buddypress_edit_activity_cancel(t){if(window.activity_content_changed&&!window.confirm(B_E_A_.warn_activity_changes))return window.keep_activity_changes=!0,!1;var i=jQuery(t),e=jQuery("#frm_buddypress-edit-activity").parent(),a="";return"comment"==i.data("target_type")?(i.closest("[id^=acomment]").find(" > .acomment-content").html(B_E_A_.current_activity_org).show(),a=i.closest("[id^=acomment]").find(".buddyboss_edit_activity_comment.action-save")):(i.closest("li").find(".activity-inner").html(B_E_A_.current_activity_org).show(),a=i.closest("li").find(".buddyboss_edit_activity.action-save")),a.removeClass("action-save").html(B_E_A_.button_text.edit),e.hide(),jQuery("body").append(e),i.remove(),window.activity_content_changed=!1,window.keep_activity_changes=!1,!1}jQuery('textarea[name="activity_content"]').on("change",function(t){window.activity_content_changed=!0}),jQuery(".acomment-reply").on("click",function(t){1==jQuery("li.activity-item #buddypress-edit-activity-wrapper").length&&($edit_wrapper=jQuery("li.activity-item #buddypress-edit-activity-wrapper"),$cancel_button=$edit_wrapper.next().children(".buddyboss_edit_activity_cancel"),$cancel_button.trigger("click"))});